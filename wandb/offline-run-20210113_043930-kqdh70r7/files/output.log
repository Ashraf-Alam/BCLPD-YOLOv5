Scanning '../coco128/labels/train2017.cache' for images and labels... 700 found, 0 missing, 0 empty, 0 corrupted: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 700/700 [00:00<?, ?it/s]Scanning '../coco128/labels/train2017.cache' for images and labels... 700 found, 0 missing, 0 empty, 0 corrupted: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 700/700 [00:00<?, ?it/s]
Scanning '../coco128/labels/train2017.cache' for images and labels... 700 found, 0 missing, 0 empty, 0 corrupted: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 700/700 [00:00<?, ?it/s]Scanning '../coco128/labels/train2017.cache' for images and labels... 700 found, 0 missing, 0 empty, 0 corrupted: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 700/700 [00:00<?, ?it/s]
Plotting labels... 
NumExpr defaulting to 4 threads.
Images sizes do not match. This will causes images to be display incorrectly in the UI.

Analyzing anchors... anchors/target = 4.90, Best Possible Recall (BPR) = 0.9985
Image sizes 640 train, 640 test
Using 4 dataloader workers
Logging results to runs/train/exp28
Starting training for 50 epochs...

     Epoch   gpu_mem       box       obj       cls     total   targets  img_size
  0%|                                                                                                                                                                                                                | 0/44 [00:00<?, ?it/s]      0/49     2.89G   0.02582  0.009601         0   0.03542        70       640:   0%|                                                                                                                              | 0/44 [00:07<?, ?it/s]      0/49     2.89G   0.02582  0.009601         0   0.03542        70       640:   2%|██▋                                                                                                                   | 1/44 [00:07<05:26,  7.58s/it]      0/49     3.07G   0.02203  0.009724         0   0.03175        62       640:   2%|██▋                                                                                                                   | 1/44 [00:12<05:26,  7.58s/it]      0/49     3.07G   0.02203  0.009724         0   0.03175        62       640:   5%|█████▎                                                                                                                | 2/44 [00:12<04:43,  6.76s/it]      0/49     3.07G   0.01999  0.008886         0   0.02887        43       640:   5%|█████▎                                                                                                                | 2/44 [00:13<04:43,  6.76s/it]      0/49     3.07G   0.01999  0.008886         0   0.02887        43       640:   7%|████████                                                                                                              | 3/44 [00:13<03:22,  4.94s/it]      0/49     3.07G   0.02003  0.009326         0   0.02936        68       640:   7%|████████                                                                                                              | 3/44 [00:13<03:22,  4.94s/it]      0/49     3.07G   0.02003  0.009326         0   0.02936        68       640:   9%|██████████▋                                                                                                           | 4/44 [00:13<02:27,  3.69s/it]      0/49     3.07G    0.0198  0.009241         0   0.02904        63       640:   9%|██████████▋                                                                                                           | 4/44 [00:14<02:27,  3.69s/it]      0/49     3.07G    0.0198  0.009241         0   0.02904        63       640:  11%|█████████████▍                                                                                                        | 5/44 [00:14<01:48,  2.78s/it]      0/49     3.07G   0.01929   0.00911         0    0.0284        57       640:  11%|█████████████▍                                                                                                        | 5/44 [00:15<01:48,  2.78s/it]      0/49     3.07G   0.01929   0.00911         0    0.0284        57       640:  14%|████████████████                                                                                                      | 6/44 [00:15<01:21,  2.15s/it]      0/49     3.07G   0.01983  0.009437         0   0.02926        62       640:  14%|████████████████                                                                                                      | 6/44 [00:15<01:21,  2.15s/it]      0/49     3.07G   0.01983  0.009437         0   0.02926        62       640:  16%|██████████████████▊                                                                                                   | 7/44 [00:15<01:02,  1.70s/it]      0/49     3.07G   0.01954  0.009216         0   0.02875        54       640:  16%|██████████████████▊                                                                                                   | 7/44 [00:16<01:02,  1.70s/it]      0/49     3.07G   0.01954  0.009216         0   0.02875        54       640:  18%|█████████████████████▍                                                                                                | 8/44 [00:16<00:49,  1.39s/it]      0/49     3.07G   0.01961  0.009024         0   0.02863        49       640:  18%|█████████████████████▍                                                                                                | 8/44 [00:17<00:49,  1.39s/it]      0/49     3.07G   0.01961  0.009024         0   0.02863        49       640:  20%|████████████████████████▏                                                                                             | 9/44 [00:17<00:41,  1.17s/it]      0/49     3.07G   0.01948   0.00892         0    0.0284        47       640:  20%|████████████████████████▏                                                                                             | 9/44 [00:17<00:41,  1.17s/it]      0/49     3.07G   0.01948   0.00892         0    0.0284        47       640:  23%|██████████████████████████▌                                                                                          | 10/44 [00:17<00:34,  1.02s/it]      0/49     3.07G   0.01909  0.008648         0   0.02774        45       640:  23%|██████████████████████████▌                                                                                          | 10/44 [00:18<00:34,  1.02s/it]      0/49     3.07G   0.01909  0.008648         0   0.02774        45       640:  25%|█████████████████████████████▎                                                                                       | 11/44 [00:18<00:30,  1.10it/s]      0/49     3.07G   0.01906  0.008666         0   0.02773        59       640:  25%|█████████████████████████████▎                                                                                       | 11/44 [00:19<00:30,  1.10it/s]      0/49     3.07G   0.01906  0.008666         0   0.02773        59       640:  27%|███████████████████████████████▉                                                                                     | 12/44 [00:19<00:26,  1.19it/s]      0/49     3.07G   0.01903  0.008546         0   0.02757        50       640:  27%|███████████████████████████████▉                                                                                     | 12/44 [00:19<00:26,  1.19it/s]      0/49     3.07G   0.01903  0.008546         0   0.02757        50       640:  30%|██████████████████████████████████▌                                                                                  | 13/44 [00:19<00:24,  1.27it/s]      0/49     3.07G   0.01903  0.008524         0   0.02755        57       640:  30%|██████████████████████████████████▌                                                                                  | 13/44 [00:20<00:24,  1.27it/s]      0/49     3.07G   0.01903  0.008524         0   0.02755        57       640:  32%|█████████████████████████████████████▏                                                                               | 14/44 [00:20<00:22,  1.33it/s]      0/49     3.07G   0.01908  0.008708         0   0.02779        61       640:  32%|█████████████████████████████████████▏                                                                               | 14/44 [00:21<00:22,  1.33it/s]      0/49     3.07G   0.01908  0.008708         0   0.02779        61       640:  34%|███████████████████████████████████████▉                                                                             | 15/44 [00:21<00:21,  1.38it/s]      0/49     3.07G   0.01914  0.008811         0   0.02795        64       640:  34%|███████████████████████████████████████▉                                                                             | 15/44 [00:21<00:21,  1.38it/s]      0/49     3.07G   0.01914  0.008811         0   0.02795        64       640:  36%|██████████████████████████████████████████▌                                                                          | 16/44 [00:21<00:19,  1.41it/s]      0/49     3.07G   0.01899  0.008796         0   0.02779        48       640:  36%|██████████████████████████████████████████▌                                                                          | 16/44 [00:22<00:19,  1.41it/s]      0/49     3.07G   0.01899  0.008796         0   0.02779        48       640:  39%|█████████████████████████████████████████████▏                                                                       | 17/44 [00:22<00:18,  1.44it/s]      0/49     3.07G   0.01894  0.008814         0   0.02775        56       640:  39%|█████████████████████████████████████████████▏                                                                       | 17/44 [00:23<00:18,  1.44it/s]      0/49     3.07G   0.01894  0.008814         0   0.02775        56       640:  41%|███████████████████████████████████████████████▊                                                                     | 18/44 [00:23<00:17,  1.46it/s]      0/49     3.07G   0.01881  0.008663         0   0.02747        45       640:  41%|███████████████████████████████████████████████▊                                                                     | 18/44 [00:23<00:17,  1.46it/s]      0/49     3.07G   0.01881  0.008663         0   0.02747        45       640:  43%|██████████████████████████████████████████████████▌                                                                  | 19/44 [00:23<00:16,  1.48it/s]      0/49     3.07G   0.01863  0.008562         0   0.02719        48       640:  43%|██████████████████████████████████████████████████▌                                                                  | 19/44 [00:24<00:16,  1.48it/s]      0/49     3.07G   0.01863  0.008562         0   0.02719        48       640:  45%|█████████████████████████████████████████████████████▏                                                               | 20/44 [00:24<00:16,  1.49it/s]      0/49     3.07G   0.01851  0.008565         0   0.02708        49       640:  45%|█████████████████████████████████████████████████████▏                                                               | 20/44 [00:25<00:16,  1.49it/s]      0/49     3.07G   0.01851  0.008565         0   0.02708        49       640:  48%|███████████████████████████████████████████████████████▊                                                             | 21/44 [00:25<00:15,  1.49it/s]      0/49     3.07G   0.01848  0.008585         0   0.02707        57       640:  48%|███████████████████████████████████████████████████████▊                                                             | 21/44 [00:25<00:15,  1.49it/s]      0/49     3.07G   0.01848  0.008585         0   0.02707        57       640:  50%|██████████████████████████████████████████████████████████▌                                                          | 22/44 [00:25<00:14,  1.49it/s]      0/49     3.07G   0.01837  0.008542         0   0.02692        43       640:  50%|██████████████████████████████████████████████████████████▌                                                          | 22/44 [00:26<00:14,  1.49it/s]      0/49     3.07G   0.01837  0.008542         0   0.02692        43       640:  52%|█████████████████████████████████████████████████████████████▏                                                       | 23/44 [00:26<00:14,  1.50it/s]      0/49     3.07G   0.01836  0.008507         0   0.02686        38       640:  52%|█████████████████████████████████████████████████████████████▏                                                       | 23/44 [00:27<00:14,  1.50it/s]      0/49     3.07G   0.01836  0.008507         0   0.02686        38       640:  55%|███████████████████████████████████████████████████████████████▊                                                     | 24/44 [00:27<00:13,  1.50it/s]      0/49     3.07G   0.01842  0.008525         0   0.02695        56       640:  55%|███████████████████████████████████████████████████████████████▊                                                     | 24/44 [00:27<00:13,  1.50it/s]      0/49     3.07G   0.01842  0.008525         0   0.02695        56       640:  57%|██████████████████████████████████████████████████████████████████▍                                                  | 25/44 [00:27<00:12,  1.50it/s]      0/49     3.07G   0.01844  0.008445         0   0.02688        44       640:  57%|██████████████████████████████████████████████████████████████████▍                                                  | 25/44 [00:28<00:12,  1.50it/s]      0/49     3.07G   0.01844  0.008445         0   0.02688        44       640:  59%|█████████████████████████████████████████████████████████████████████▏                                               | 26/44 [00:28<00:11,  1.50it/s]      0/49     3.07G   0.01849  0.008456         0   0.02694        55       640:  59%|█████████████████████████████████████████████████████████████████████▏                                               | 26/44 [00:29<00:11,  1.50it/s]      0/49     3.07G   0.01849  0.008456         0   0.02694        55       640:  61%|███████████████████████████████████████████████████████████████████████▊                                             | 27/44 [00:29<00:11,  1.49it/s]      0/49     3.07G   0.01854  0.008446         0   0.02699        51       640:  61%|███████████████████████████████████████████████████████████████████████▊                                             | 27/44 [00:29<00:11,  1.49it/s]      0/49     3.07G   0.01854  0.008446         0   0.02699        51       640:  64%|██████████████████████████████████████████████████████████████████████████▍                                          | 28/44 [00:29<00:10,  1.49it/s]      0/49     3.07G   0.01848  0.008464         0   0.02694        51       640:  64%|██████████████████████████████████████████████████████████████████████████▍                                          | 28/44 [00:30<00:10,  1.49it/s]      0/49     3.07G   0.01848  0.008464         0   0.02694        51       640:  66%|█████████████████████████████████████████████████████████████████████████████                                        | 29/44 [00:30<00:10,  1.49it/s]      0/49     3.07G   0.01847  0.008406         0   0.02688        45       640:  66%|█████████████████████████████████████████████████████████████████████████████                                        | 29/44 [00:31<00:10,  1.49it/s]      0/49     3.07G   0.01847  0.008406         0   0.02688        45       640:  68%|███████████████████████████████████████████████████████████████████████████████▊                                     | 30/44 [00:31<00:09,  1.49it/s]      0/49     3.07G   0.01841   0.00834         0   0.02675        36       640:  68%|███████████████████████████████████████████████████████████████████████████████▊                                     | 30/44 [00:31<00:09,  1.49it/s]      0/49     3.07G   0.01841   0.00834         0   0.02675        36       640:  70%|██████████████████████████████████████████████████████████████████████████████████▍                                  | 31/44 [00:31<00:08,  1.50it/s]      0/49     3.07G   0.01837  0.008344         0   0.02671        48       640:  70%|██████████████████████████████████████████████████████████████████████████████████▍                                  | 31/44 [00:32<00:08,  1.50it/s]      0/49     3.07G   0.01837  0.008344         0   0.02671        48       640:  73%|█████████████████████████████████████████████████████████████████████████████████████                                | 32/44 [00:32<00:08,  1.49it/s]      0/49     3.07G   0.01835  0.008354         0    0.0267        56       640:  73%|█████████████████████████████████████████████████████████████████████████████████████                                | 32/44 [00:33<00:08,  1.49it/s]      0/49     3.07G   0.01835  0.008354         0    0.0267        56       640:  75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 33/44 [00:33<00:07,  1.49it/s]      0/49     3.07G    0.0183  0.008473         0   0.02677        73       640:  75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 33/44 [00:33<00:07,  1.49it/s]      0/49     3.07G    0.0183  0.008473         0   0.02677        73       640:  77%|██████████████████████████████████████████████████████████████████████████████████████████▍                          | 34/44 [00:33<00:06,  1.49it/s]      0/49     3.07G   0.01836  0.008568         0   0.02692        82       640:  77%|██████████████████████████████████████████████████████████████████████████████████████████▍                          | 34/44 [00:34<00:06,  1.49it/s]      0/49     3.07G   0.01836  0.008568         0   0.02692        82       640:  80%|█████████████████████████████████████████████████████████████████████████████████████████████                        | 35/44 [00:34<00:06,  1.49it/s]      0/49     3.07G   0.01833  0.008546         0   0.02688        57       640:  80%|█████████████████████████████████████████████████████████████████████████████████████████████                        | 35/44 [00:35<00:06,  1.49it/s]      0/49     3.07G   0.01833  0.008546         0   0.02688        57       640:  82%|███████████████████████████████████████████████████████████████████████████████████████████████▋                     | 36/44 [00:35<00:05,  1.49it/s]      0/49     3.07G   0.01835   0.00856         0   0.02691        53       640:  82%|███████████████████████████████████████████████████████████████████████████████████████████████▋                     | 36/44 [00:35<00:05,  1.49it/s]      0/49     3.07G   0.01835   0.00856         0   0.02691        53       640:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 37/44 [00:35<00:04,  1.49it/s]      0/49     3.07G   0.01833  0.008543         0   0.02687        55       640:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 37/44 [00:36<00:04,  1.49it/s]      0/49     3.07G   0.01833  0.008543         0   0.02687        55       640:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████                | 38/44 [00:36<00:04,  1.49it/s]      0/49     3.07G    0.0183  0.008552         0   0.02685        62       640:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████                | 38/44 [00:37<00:04,  1.49it/s]      0/49     3.07G    0.0183  0.008552         0   0.02685        62       640:  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 39/44 [00:37<00:03,  1.49it/s]      0/49     3.07G   0.01832  0.008572         0   0.02689        71       640:  89%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 39/44 [00:37<00:03,  1.49it/s]      0/49     3.07G   0.01832  0.008572         0   0.02689        71       640:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 40/44 [00:37<00:02,  1.49it/s]      0/49     3.07G   0.01829  0.008616         0    0.0269        61       640:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 40/44 [00:38<00:02,  1.49it/s]      0/49     3.07G   0.01829  0.008616         0    0.0269        61       640:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 41/44 [00:38<00:02,  1.49it/s]      0/49     3.07G   0.01826    0.0086         0   0.02686        59       640:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 41/44 [00:39<00:02,  1.49it/s]      0/49     3.07G   0.01826    0.0086         0   0.02686        59       640:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 42/44 [00:39<00:01,  1.50it/s]      0/49     3.07G   0.01825  0.008603         0   0.02686        58       640:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 42/44 [00:39<00:01,  1.50it/s]      0/49     3.07G   0.01825  0.008603         0   0.02686        58       640:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 43/44 [00:39<00:00,  1.50it/s]      0/49     2.46G   0.01821  0.008549         0   0.02676        33       640:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 43/44 [00:43<00:00,  1.50it/s]      0/49     2.46G   0.01821  0.008549         0   0.02676        33       640: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:43<00:00,  1.45s/it]      0/49     2.46G   0.01821  0.008549         0   0.02676        33       640: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:43<00:00,  1.02it/s]
               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95:   0%|                                                                                                                  | 0/44 [00:00<?, ?it/s]               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95:   0%|                                                                                                                  | 0/44 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 520, in <module>
    train(hyp, opt, device, tb_writer, wandb)
  File "train.py", line 342, in train
    results, maps, times = test.test(opt.data,
  File "/home/ashraf/yolov5/test.py", line 109, in test
    inf_out, train_out = model(img, augment=augment)  # inference and training outputs
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ashraf/yolov5/models/yolo.py", line 119, in forward
    return self.forward_once(x, profile)  # single-scale inference, train
  File "/home/ashraf/yolov5/models/yolo.py", line 135, in forward_once
    x = m(x)  # run
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ashraf/yolov5/models/common.py", line 86, in forward
    return self.cv3(torch.cat((self.m(self.cv1(x)), self.cv2(x)), dim=1))
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ashraf/yolov5/models/common.py", line 52, in forward
    return x + self.cv2(self.cv1(x)) if self.add else self.cv2(self.cv1(x))
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ashraf/yolov5/models/common.py", line 36, in forward
    return self.act(self.bn(self.conv(x)))
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 423, in forward
    return self._conv_forward(input, self.weight)
  File "/home/ashraf/anaconda3/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 419, in _conv_forward
    return F.conv2d(input, weight, self.bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 776.00 MiB (GPU 0; 3.94 GiB total capacity; 271.15 MiB already allocated; 777.88 MiB free; 2.29 GiB reserved in total by PyTorch)
